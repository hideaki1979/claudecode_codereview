# GitHub Actionsè‡ªå‹•ãƒ©ãƒ™ãƒ«ä»˜ä¸ã®è¨­å®šã‚¬ã‚¤ãƒ‰

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€PRåˆ†æã¨è‡ªå‹•ãƒ©ãƒ™ãƒ«ä»˜ä¸ã®GitHub Actionsã‚’è¨­å®šã™ã‚‹æ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## ğŸ“‹ æ©Ÿèƒ½æ¦‚è¦

PRãŒä½œæˆãƒ»æ›´æ–°ã•ã‚Œã‚‹ãŸã³ã«è‡ªå‹•çš„ã«:
- PRå·®åˆ†ã‚’åˆ†æ
- ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«ã‚’è©•ä¾¡
- é©åˆ‡ãªãƒ©ãƒ™ãƒ«ã‚’è‡ªå‹•ä»˜ä¸
- åˆ†æçµæœã‚’ã‚³ãƒ¡ãƒ³ãƒˆã§é€šçŸ¥

## ğŸ·ï¸ è‡ªå‹•ä»˜ä¸ã•ã‚Œã‚‹ãƒ©ãƒ™ãƒ«

### ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«
- ğŸŸ¢ `low-risk` - ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«: ä½
- ğŸŸ¡ `medium-risk` - ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«: ä¸­
- ğŸ”´ `high-risk` - ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«: é«˜
- ğŸš¨ `critical-risk` - ãƒªã‚¹ã‚¯ãƒ¬ãƒ™ãƒ«: ç·Šæ€¥

### ç‰¹å¾´ãƒ•ãƒ©ã‚°
- ğŸ“Š `large-changes` - 500è¡Œä»¥ä¸Šã®å¤§è¦æ¨¡å¤‰æ›´
- âš ï¸ `critical-files-modified` - package.json, .envãªã©ã®é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´
- ğŸ”’ `security-review-needed` - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ“ãƒ¥ãƒ¼æ¨å¥¨ï¼ˆå°†æ¥å®Ÿè£…ï¼‰

## ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. ãƒªãƒã‚¸ãƒˆãƒªæ¨©é™ã®ç¢ºèª

GitHub ActionsãŒãƒ©ãƒ™ãƒ«ã‚’ä»˜ä¸ã§ãã‚‹ã‚ˆã†ã«ã€ãƒªãƒã‚¸ãƒˆãƒªè¨­å®šã‚’ç¢ºèªã—ã¾ã™ã€‚

1. ãƒªãƒã‚¸ãƒˆãƒªã® **Settings** â†’ **Actions** â†’ **General** ã‚’é–‹ã
2. **Workflow permissions** ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ä»¥ä¸‹ã‚’ç¢ºèª:
   - âœ… "Read and write permissions" ã‚’é¸æŠ
   - âœ… "Allow GitHub Actions to create and approve pull requests" ã«ãƒã‚§ãƒƒã‚¯

### 2. ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ—ãƒƒã‚·ãƒ¥

ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒãƒªãƒã‚¸ãƒˆãƒªã«å«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª:

```text
.github/
â”œâ”€â”€ workflows/
â”‚   â””â”€â”€ pr-analysis.yml       # ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®šç¾©
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ analyze-and-label.js  # åˆ†æãƒ»ãƒ©ãƒ™ãƒ«ä»˜ä¸ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
â””â”€â”€ ACTIONS_SETUP.md          # ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«
```

ã“ã‚Œã‚‰ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’mainãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ã—ã¾ã™:

```bash
git add .github/
git commit -m "feat: GitHub Actionsè‡ªå‹•ãƒ©ãƒ™ãƒ«ä»˜ä¸ã‚’è¿½åŠ "
git push origin main
```

### 3. å‹•ä½œç¢ºèª

ãƒ†ã‚¹ãƒˆç”¨ã®PRã‚’ä½œæˆã—ã¦å‹•ä½œã‚’ç¢ºèª:

1. æ–°ã—ã„ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ
   ```bash
   git checkout -b test/auto-labeling
   ```

2. ä½•ã‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å¤‰æ›´
   ```bash
   echo "# Test" >> test.md
   git add test.md
   git commit -m "test: GitHub Actionså‹•ä½œç¢ºèª"
   git push origin test/auto-labeling
   ```

3. GitHubã§PRã‚’ä½œæˆ

4. **Actions** ã‚¿ãƒ–ã§ "PR Analysis & Auto Labeling" ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè¡Œã‚’ç¢ºèª

5. PRãƒšãƒ¼ã‚¸ã§ãƒ©ãƒ™ãƒ«ãŒè‡ªå‹•ä»˜ä¸ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

6. åˆ†æçµæœã®ã‚³ãƒ¡ãƒ³ãƒˆãŒæŠ•ç¨¿ã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª

## ğŸ”§ ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

### ãƒ©ãƒ™ãƒ«ã®è¿½åŠ ãƒ»å¤‰æ›´

`.github/scripts/analyze-and-label.js` ã® `LABELS` ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç·¨é›†:

```javascript
const LABELS = {
  risk: {
    // ... æ—¢å­˜ã®ãƒ©ãƒ™ãƒ« ...
  },
  features: {
    // æ–°ã—ã„ãƒ©ãƒ™ãƒ«ã‚’è¿½åŠ 
    customLabel: {
      name: 'custom-label',
      color: '0052CC',
      description: 'ã‚«ã‚¹ã‚¿ãƒ ãƒ©ãƒ™ãƒ«'
    },
  },
};
```

### åˆ†æãƒ­ã‚¸ãƒƒã‚¯ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º

`analyzeSimplified()` é–¢æ•°ã‚’ç·¨é›†ã—ã¦ç‹¬è‡ªã®åˆ†æãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã§ãã¾ã™ã€‚

æœ¬æ ¼çš„ãªåˆ†æãŒå¿…è¦ãªå ´åˆã¯ã€`src/lib/analysis` ã®æ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã‚‚å¯èƒ½ã§ã™ã€‚

### ãƒˆãƒªã‚¬ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆã®å¤‰æ›´

`.github/workflows/pr-analysis.yml` ã® `on` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç·¨é›†:

```yaml
on:
  pull_request:
    types: [opened, synchronize, reopened, ready_for_review]
```

## ğŸ› ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### ãƒ©ãƒ™ãƒ«ãŒä»˜ä¸ã•ã‚Œãªã„

1. **æ¨©é™ã‚’ç¢ºèª**:
   - Settings â†’ Actions â†’ General â†’ Workflow permissions ãŒ "Read and write permissions" ã«ãªã£ã¦ã„ã‚‹ã‹

2. **ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®å®Ÿè¡Œãƒ­ã‚°ã‚’ç¢ºèª**:
   - Actions ã‚¿ãƒ–ã§è©²å½“ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œã‚’é–‹ã
   - ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ç¢ºèª

3. **GITHUB_TOKEN ã®æ¨©é™ã‚’ç¢ºèª**:
   - ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ«ã® `permissions` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ç¢ºèª

### åˆ†æçµæœãŒä¸æ­£ç¢º

- `.github/scripts/analyze-and-label.js` ã® `analyzeSimplified()` é–¢æ•°ã‚’ç¢ºèª
- å¿…è¦ã«å¿œã˜ã¦é–¾å€¤ã‚’èª¿æ•´

### ã‚³ãƒ¡ãƒ³ãƒˆãŒæŠ•ç¨¿ã•ã‚Œãªã„

- `analysis-result.json` ãŒæ­£ã—ãç”Ÿæˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
- Actions ãƒ­ã‚°ã§ "Comment Analysis Results" ã‚¹ãƒ†ãƒƒãƒ—ã®ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèª

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [Octokit REST API](https://octokit.github.io/rest.js/)
- [GitHub Actions: permissions](https://docs.github.com/en/actions/using-jobs/assigning-permissions-to-jobs)

## ğŸ’¡ ä»Šå¾Œã®æ‹¡å¼µæ¡ˆ

- [ ] ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ã‚¹ã‚­ãƒ£ãƒ³ã®çµ±åˆ
- [ ] ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã®è©•ä¾¡
- [ ] AIï¼ˆClaude/GPT-4ï¼‰ã«ã‚ˆã‚‹ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ææ¡ˆ
- [ ] Slack/Discordé€šçŸ¥
- [ ] åˆ†æçµæœã®ãƒˆãƒ¬ãƒ³ãƒ‰è¿½è·¡
